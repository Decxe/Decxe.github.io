<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>皇帝选举投票系统</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#D97706', // 主色调-金色
            secondary: '#10B981', // 辅助色-绿色
            accent: '#8B5CF6', // 强调色-紫色
            neutral: '#1F2937', // 中性色-深灰
            'base-100': '#111827', // 背景色-更深灰
            'info': '#3ABFF8',
            'success': '#36D399',
            'warning': '#FBBD23',
            'error': '#F87272',
          },
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .text-shadow-lg {
        text-shadow: 0 4px 8px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.08);
      }
      .backdrop-blur {
        backdrop-filter: blur(8px);
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .voting-card {
        transition: all 0.3s ease;
      }
      .voting-card:hover {
        transform: translateY(-5px);
      }
      .vote-animation {
        animation: pulse 0.5s ease-in-out;
      }
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
      }
      .rank-up {
        animation: rank-up 1s ease-out;
      }
      @keyframes rank-up {
        0% { color: #36D399; }
        100% { color: inherit; }
      }
      .rank-down {
        animation: rank-down 1s ease-out;
      }
      @keyframes rank-down {
        0% { color: #F87272; }
        100% { color: inherit; }
      }
      .emperor-crown {
        color: #D97706;
        font-size: 1.2em;
      }
      .young-prince-crown {
        color: #8B5CF6;
        font-size: 1em;
      }
      .prince-crown {
        color: #3ABFF8;
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body class="font-inter bg-base-100 text-gray-100 min-h-screen flex flex-col">
  <!-- 导航栏 -->
  <header class="bg-neutral/80 backdrop-blur fixed w-full z-50 transition-all duration-300" id="navbar">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <i class="fa fa-crown text-primary text-2xl"></i>
        <h1 class="text-xl font-bold">皇帝选举投票系统</h1>
      </div>
      
      <nav class="hidden md:flex items-center space-x-6">
        <a href="#voting" class="text-gray-300 hover:text-primary transition-colors">投票</a>
        <a href="#ranking" class="text-gray-300 hover:text-primary transition-colors">排名</a>
        <a href="#stats" class="text-gray-300 hover:text-primary transition-colors">统计</a>
        <a href="#about" class="text-gray-300 hover:text-primary transition-colors">关于</a>
      </nav>
      
      <div class="flex items-center space-x-4">
        <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-700 transition-colors">
          <i class="fa fa-moon-o"></i>
        </button>
        <button id="login-button" class="hidden md:block bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-all transform hover:scale-105 flex items-center">
          <i class="fa fa-user mr-2"></i> 登录
        </button>
        <button id="mobile-menu-button" class="md:hidden p-2 rounded-full hover:bg-gray-700 transition-colors">
          <i class="fa fa-bars"></i>
        </button>
      </div>
    </div>
    
    <!-- 移动端菜单 -->
    <div id="mobile-menu" class="md:hidden bg-neutral/95 backdrop-blur hidden">
      <div class="container mx-auto px-4 py-3 flex flex-col space-y-3">
        <a href="#voting" class="text-gray-300 hover:text-primary py-2 transition-colors">投票</a>
        <a href="#ranking" class="text-gray-300 hover:text-primary py-2 transition-colors">排名</a>
        <a href="#stats" class="text-gray-300 hover:text-primary py-2 transition-colors">统计</a>
        <a href="#about" class="text-gray-300 hover:text-primary py-2 transition-colors">关于</a>
        <button id="mobile-login-button" class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-all transform hover:scale-105 flex items-center justify-center">
          <i class="fa fa-user mr-2"></i> 登录
        </button>
      </div>
    </div>
  </header>

  <!-- 主内容 -->
  <main class="flex-grow pt-16">
    <!-- 英雄区域 -->
    <section class="relative min-h-[60vh] flex items-center justify-center overflow-hidden">
      <div class="absolute inset-0 z-0">
        <img src="https://picsum.photos/seed/palace/1920/1080" alt="背景" class="w-full h-full object-cover opacity-20">
        <div class="absolute inset-0 bg-gradient-to-b from-base-100/80 to-base-100"></div>
      </div>
      
      <div class="container mx-auto px-4 z-10 text-center">
        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold mb-6 leading-tight">
          皇帝<span class="text-primary">选举</span>投票系统
        </h1>
        <p class="text-[clamp(1rem,2vw,1.25rem)] text-gray-300 max-w-2xl mx-auto mb-8">
          为您心目中的皇帝、小皇弟和皇弟投票，每天限投一票，实时查看排名变化
        </p>
        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <button id="hero-vote-button" class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-lg transition-all transform hover:scale-105 flex items-center justify-center">
            <i class="fa fa-thumbs-up mr-2"></i> 立即投票
          </button>
          <button class="bg-gray-800 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition-all flex items-center justify-center">
            <i class="fa fa-bar-chart mr-2"></i> 查看排名
          </button>
        </div>
      </div>
    </section>
    
    <!-- 投票区域 -->
    <section id="voting" class="py-16 bg-base-100">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4">候选人投票</h2>
          <p class="text-gray-400 max-w-2xl mx-auto">选择您支持的候选人投票，每人每天限投一票</p>
        </div>
        
        <!-- 投票状态提示 -->
        <div id="vote-status" class="mb-8 bg-neutral rounded-xl p-4 flex items-center justify-between">
          <div class="flex items-center">
            <i class="fa fa-info-circle text-primary mr-2"></i>
            <span id="vote-status-text">您今天还没有投票</span>
          </div>
          <div id="vote-reset-timer" class="text-sm text-gray-400">
            投票将于 <span id="reset-time">23:59</span> 重置
          </div>
        </div>
        
        <!-- 候选人网格 -->
        <div id="candidates-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
          <!-- 候选人卡片将通过JavaScript动态生成 -->
        </div>
      </div>
    </section>
    
    <!-- 排名区域 -->
    <section id="ranking" class="py-16 bg-neutral">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4">当前排名</h2>
          <p class="text-gray-400 max-w-2xl mx-auto">查看候选人的实时投票排名</p>
        </div>
        
        <!-- 排名列表 -->
        <div id="ranking-list" class="bg-base-100 rounded-xl overflow-hidden shadow-xl max-w-4xl mx-auto">
          <div class="p-4 border-b border-gray-800 flex items-center justify-between">
            <h3 class="font-semibold flex items-center">
              <i class="fa fa-trophy text-primary mr-2"></i> 候选人排名
            </h3>
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-400">排序方式:</span>
              <select id="sort-select" class="bg-gray-800 border border-gray-700 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-primary">
                <option value="votes-desc">票数从高到低</option>
                <option value="votes-asc">票数从低到高</option>
                <option value="name-asc">姓名从A到Z</option>
                <option value="name-desc">姓名从Z到A</option>
              </select>
            </div>
          </div>
          
          <div class="p-4">
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead>
                  <tr class="text-left text-gray-400">
                    <th class="pb-3 font-medium">排名</th>
                    <th class="pb-3 font-medium">候选人</th>
                    <th class="pb-3 font-medium">票数</th>
                    <th class="pb-3 font-medium">角色</th>
                    <th class="pb-3 font-medium">趋势</th>
                  </tr>
                </thead>
                <tbody id="ranking-body">
                  <!-- 排名数据将通过JavaScript动态生成 -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- 统计区域 -->
    <section id="stats" class="py-16 bg-base-100">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4">投票统计</h2>
          <p class="text-gray-400 max-w-2xl mx-auto">查看候选人的投票分布情况</p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-5xl mx-auto">
          <!-- 候选人投票分布 -->
          <div class="bg-neutral rounded-xl p-6 shadow-lg">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
              <i class="fa fa-pie-chart text-primary mr-2"></i> 候选人得票分布
            </h3>
            <div class="h-80">
              <canvas id="candidates-stats-chart"></canvas>
            </div>
          </div>
          
          <!-- 总投票数 -->
          <div class="bg-neutral rounded-xl p-6 shadow-lg">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
              <i class="fa fa-bar-chart text-primary mr-2"></i> 投票数据
            </h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="bg-base-100 rounded-lg p-4">
                <div class="text-sm text-gray-400 mb-1">总投票数</div>
                <div class="text-3xl font-bold text-white" id="total-votes">0</div>
                <div class="text-xs text-success mt-1">
                  <i class="fa fa-arrow-up"></i> 较昨日 +12.5%
                </div>
              </div>
              
              <div class="bg-base-100 rounded-lg p-4">
                <div class="text-sm text-gray-400 mb-1">今日投票</div>
                <div class="text-3xl font-bold text-white" id="today-votes">0</div>
                <div class="text-xs text-success mt-1">
                  <i class="fa fa-arrow-up"></i> 较昨日 +8.3%
                </div>
              </div>
              
              <div class="bg-base-100 rounded-lg p-4">
                <div class="text-sm text-gray-400 mb-1">参与用户</div>
                <div class="text-3xl font-bold text-white" id="active-users">0</div>
                <div class="text-xs text-success mt-1">
                  <i class="fa fa-arrow-up"></i> 较昨日 +5.2%
                </div>
              </div>
              
              <div class="bg-base-100 rounded-lg p-4">
                <div class="text-sm text-gray-400 mb-1">投票率</div>
                <div class="text-3xl font-bold text-white" id="vote-rate">0%</div>
                <div class="text-xs text-success mt-1">
                  <i class="fa fa-arrow-up"></i> 较昨日 +2.1%
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- 关于区域 -->
    <section id="about" class="py-16 bg-neutral">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4">关于系统</h2>
          <p class="text-gray-400 max-w-2xl mx-auto">了解更多关于皇帝选举投票排名系统的信息</p>
        </div>
        
        <div class="max-w-3xl mx-auto">
          <div class="bg-base-100 rounded-xl p-6 shadow-lg mb-8">
            <h3 class="text-xl font-semibold mb-4">系统说明</h3>
            <p class="text-gray-300 mb-4">
              皇帝选举投票排名系统是一个用于选举皇帝、小皇弟和皇弟的平台。用户每天可以投一票给任意候选人，系统会实时更新排名并展示结果。
            </p>
            <p class="text-gray-300">
              选举结束后，得票最多的候选人将被封为皇帝，第二名被封为小皇弟，第三名被封为皇弟。
            </p>
          </div>
          
          <div class="bg-base-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-xl font-semibold mb-4">使用规则</h3>
            <ul class="space-y-3 text-gray-300">
              <li class="flex items-start">
                <i class="fa fa-check-circle text-success mt-1 mr-2"></i>
                <span>每位用户每天只能投一票</span>
              </li>
              <li class="flex items-start">
                <i class="fa fa-check-circle text-success mt-1 mr-2"></i>
                <span>投票时间为每天00:00至23:59</span>
              </li>
              <li class="flex items-start">
                <i class="fa fa-check-circle text-success mt-1 mr-2"></i>
                <span>投票后可以在排名页面查看实时结果</span>
              </li>
              <li class="flex items-start">
                <i class="fa fa-check-circle text-success mt-1 mr-2"></i>
                <span>系统会记录投票历史和排名变化</span>
              </li>
              <li class="flex items-start">
                <i class="fa fa-check-circle text-success mt-1 mr-2"></i>
                <span>禁止使用任何自动化工具或作弊行为</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="bg-neutral border-t border-gray-800">
    <div class="container mx-auto px-4 py-12">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- 系统信息 -->
        <div>
          <div class="flex items-center space-x-2 mb-4">
            <i class="fa fa-crown text-primary text-2xl"></i>
            <h2 class="text-xl font-bold">皇帝选举投票系统</h2>
          </div>
          <p class="text-gray-400 mb-4">为您喜爱的候选人投票，实时查看排名变化。</p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-primary transition-colors">
              <i class="fa fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-primary transition-colors">
              <i class="fa fa-facebook"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-primary transition-colors">
              <i class="fa fa-instagram"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-primary transition-colors">
              <i class="fa fa-github"></i>
            </a>
          </div>
        </div>
        
        <!-- 快速链接 -->
        <div>
          <h3 class="text-lg font-semibold mb-4">快速链接</h3>
          <ul class="space-y-2">
            <li><a href="#voting" class="text-gray-400 hover:text-primary transition-colors">投票</a></li>
            <li><a href="#ranking" class="text-gray-400 hover:text-primary transition-colors">排名</a></li>
            <li><a href="#stats" class="text-gray-400 hover:text-primary transition-colors">统计</a></li>
            <li><a href="#about" class="text-gray-400 hover:text-primary transition-colors">关于</a></li>
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">帮助中心</a></li>
          </ul>
        </div>
        
        <!-- 支持 -->
        <div>
          <h3 class="text-lg font-semibold mb-4">支持</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">常见问题</a></li>
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">使用教程</a></li>
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">联系我们</a></li>
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">隐私政策</a></li>
            <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">服务条款</a></li>
          </ul>
        </div>
        
        <!-- 订阅 -->
        <div>
          <h3 class="text-lg font-semibold mb-4">订阅更新</h3>
          <p class="text-gray-400 mb-4">获取系统更新和活动通知</p>
          <form class="flex">
            <input type="email" placeholder="您的邮箱地址" class="flex-1 bg-base-100 border border-gray-700 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary">
            <button type="submit" class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-r-lg transition-colors">
              <i class="fa fa-paper-plane"></i>
            </button>
          </form>
        </div>
      </div>
      
      <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
        <p class="text-gray-500 text-sm">© 2025 皇帝选举投票系统. 保留所有权利。</p>
        <div class="flex space-x-6 mt-4 md:mt-0">
          <a href="#" class="text-gray-500 hover:text-primary text-sm transition-colors">隐私政策</a>
          <a href="#" class="text-gray-500 hover:text-primary text-sm transition-colors">服务条款</a>
          <a href="#" class="text-gray-500 hover:text-primary text-sm transition-colors">Cookie 政策</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化数据
      let candidatesData = [];
      let userVote = null;
      let userVoteTime = null;
      
      // 初始化候选人数据
      function initCandidatesData() {
        candidatesData = [
          {
            id: 1,
            name: "许宇飞",
            votes: 150, // 预设皇帝
            role: "皇帝",
            prevRank: null,
            currentRank: null,
            avatar: "https://picsum.photos/seed/xuyufei/200/200",
            crown: "👑"
          },
          {
            id: 2,
            name: "赵博洋",
            votes: 120, // 预设小皇弟
            role: "小皇弟",
            prevRank: null,
            currentRank: null,
            avatar: "https://picsum.photos/seed/zhaoboyang/200/200",
            crown: "👑"
          },
          {
            id: 3,
            name: "金胜利",
            votes: 90, // 预设皇弟
            role: "皇弟",
            prevRank: null,
            currentRank: null,
            avatar: "https://picsum.photos/seed/jinshengli/200/200",
            crown: "👑"
          }
        ];
        
        // 计算初始排名
        updateRanking();
      }
      
      // 更新排名
      function updateRanking() {
        // 按票数降序排序
        candidatesData.sort((a, b) => b.votes - a.votes);
        
        // 分配排名
        candidatesData.forEach((candidate, index) => {
          candidate.prevRank = candidate.currentRank;
          candidate.currentRank = index + 1;
          
          // 根据排名更新角色
          if (index === 0) {
            candidate.role = "皇帝";
            candidate.crown = "👑";
          } else if (index === 1) {
            candidate.role = "小皇弟";
            candidate.crown = "👑";
          } else if (index === 2) {
            candidate.role = "皇弟";
            candidate.crown = "👑";
          }
        });
      }
      
      // 渲染候选人卡片
      function renderCandidatesGrid() {
        const candidatesGrid = document.getElementById('candidates-grid');
        candidatesGrid.innerHTML = '';
        
        candidatesData.forEach(candidate => {
          const candidateCard = document.createElement('div');
          candidateCard.className = 'voting-card bg-neutral rounded-xl overflow-hidden hover:shadow-lg cursor-pointer';
          
          // 检查用户是否已经投过票
          const hasVoted = userVote === candidate.id;
          
          // 确定卡片样式
          if (hasVoted) {
            candidateCard.classList.add('border-2', 'border-primary', 'bg-primary/10');
          }
          
          // 添加头像区域
          const avatarContainer = document.createElement('div');
          avatarContainer.className = 'relative h-48';
          
          const avatarImg = document.createElement('img');
          avatarImg.src = candidate.avatar;
          avatarImg.alt = candidate.name;
          avatarImg.className = 'w-full h-full object-cover';
          
          const roleBadge = document.createElement('div');
          roleBadge.className = `absolute top-3 left-3 px-3 py-1 rounded-full text-xs font-medium ${
            candidate.role === "皇帝" ? "bg-yellow-500 text-white" : 
            candidate.role === "小皇弟" ? "bg-purple-500 text-white" : "bg-blue-500 text-white"
          }`;
          roleBadge.textContent = candidate.role;
          
          avatarContainer.appendChild(avatarImg);
          avatarContainer.appendChild(roleBadge);
          
          // 添加候选人信息
          const infoContainer = document.createElement('div');
          infoContainer.className = 'p-5';
          
          const nameRow = document.createElement('div');
          nameRow.className = 'flex items-center justify-between mb-2';
          
          const name = document.createElement('h3');
          name.className = 'text-xl font-bold';
          name.innerHTML = `${candidate.name} ${candidate.crown}`;
          
          const rankBadge = document.createElement('div');
          rankBadge.className = `px-2 py-1 rounded-full text-xs font-medium ${
            candidate.currentRank === 1 ? "bg-yellow-500 text-white" : 
            candidate.currentRank === 2 ? "bg-gray-500 text-white" : "bg-gray-700 text-gray-300"
          }`;
          rankBadge.textContent = `第 ${candidate.currentRank} 名`;
          
          nameRow.appendChild(name);
          nameRow.appendChild(rankBadge);
          
          const votesCount = document.createElement('div');
          votesCount.className = 'text-sm text-gray-400 mb-4';
          votesCount.textContent = `${candidate.votes} 票`;
          
          // 添加投票按钮
          const voteButton = document.createElement('button');
          voteButton.className = `vote-button w-full py-2 rounded-lg transition-all ${hasVoted ? 'bg-primary text-white' : 'bg-gray-800 hover:bg-gray-700 text-gray-300'}`;
          voteButton.textContent = hasVoted ? '已投票' : '投票';
          voteButton.disabled = userVote !== null && userVote !== candidate.id;
          
          // 添加投票事件
          voteButton.addEventListener('click', () => {
            if (!voteButton.disabled) {
              handleVote(candidate.id);
            }
          });
          
          // 组装卡片
          infoContainer.appendChild(nameRow);
          infoContainer.appendChild(votesCount);
          infoContainer.appendChild(voteButton);
          
          candidateCard.appendChild(avatarContainer);
          candidateCard.appendChild(infoContainer);
          
          // 添加到网格
          candidatesGrid.appendChild(candidateCard);
        });
      }
      
      // 处理投票
      function handleVote(candidateId) {
        // 如果用户今天已经投票，并且尝试投给不同的候选人
        if (userVote !== null && userVote !== candidateId && !isVoteExpired()) {
          alert('您今天已经投过票了，每天只能投一票');
          return;
        }
        
        // 更新投票状态
        userVote = candidateId;
        userVoteTime = new Date().toISOString();
        
        // 更新候选人票数
        const candidate = candidatesData.find(c => c.id === candidateId);
        if (candidate) {
          candidate.votes += 1;
        }
        
        // 更新排名
        updateRanking();
        
        // 更新UI
        updateVoteStatus();
        renderCandidatesGrid();
        renderRankingList();
        updateStats();
        
        // 添加投票动画效果
        const votedCard = document.querySelector(`.voting-card:has(.vote-button:contains('已投票'))`);
        if (votedCard) {
          votedCard.classList.add('vote-animation');
          setTimeout(() => {
            votedCard.classList.remove('vote-animation');
          }, 500);
        }
        
        // 保存到本地存储
        saveVoteData();
      }
      
      // 检查投票是否过期
      function isVoteExpired() {
        if (!userVoteTime) return true;
        
        const voteDate = new Date(userVoteTime);
        const today = new Date();
        
        // 检查是否是同一天
        return voteDate.getDate() !== today.getDate() ||
               voteDate.getMonth() !== today.getMonth() ||
               voteDate.getFullYear() !== today.getFullYear();
      }
      
      // 更新投票状态
      function updateVoteStatus() {
        const voteStatusText = document.getElementById('vote-status-text');
        const voteResetTime = document.getElementById('reset-time');
        
        // 计算重置时间
        const now = new Date();
        const resetTime = new Date(now);
        resetTime.setHours(23, 59, 59, 0);
        
        const hours = resetTime.getHours().toString().padStart(2, '0');
        const minutes = resetTime.getMinutes().toString().padStart(2, '0');
        
        voteResetTime.textContent = `${hours}:${minutes}`;
        
        // 更新投票状态
        if (userVote && !isVoteExpired()) {
          const candidate = candidatesData.find(c => c.id === userVote);
          voteStatusText.innerHTML = `您今天已投票给 <span class="text-primary font-medium">${candidate ? candidate.name : userVote}</span> (${candidate ? candidate.role : '未知角色'})`;
        } else {
          voteStatusText.textContent = '您今天还没有投票';
        }
      }
      
      // 渲染排名列表
      function renderRankingList() {
        const rankingBody = document.getElementById('ranking-body');
        rankingBody.innerHTML = '';
        
        // 根据排序选项排序
        const sortSelect = document.getElementById('sort-select');
        const sortValue = sortSelect.value;
        
        let sortedCandidates = [...candidatesData];
        
        switch (sortValue) {
          case 'votes-desc':
            sortedCandidates.sort((a, b) => b.votes - a.votes);
            break;
          case 'votes-asc':
            sortedCandidates.sort((a, b) => a.votes - b.votes);
            break;
          case 'name-asc':
            sortedCandidates.sort((a, b) => a.name.localeCompare(b.name));
            break;
          case 'name-desc':
            sortedCandidates.sort((a, b) => b.name.localeCompare(a.name));
            break;
        }
        
        // 更新显示排名
        sortedCandidates.forEach((candidate, index) => {
          candidate.displayRank = index + 1;
        });
        
        // 渲染列表
        sortedCandidates.forEach(candidate => {
          const row = document.createElement('tr');
          row.className = 'border-b border-gray-800 hover:bg-gray-800/50 transition-colors';
          
          // 排名单元格
          const rankCell = document.createElement('td');
          rankCell.className = 'py-3 font-medium';
          
          // 添加排名变化指示
          let rankChange = '';
          let rankClass = '';
          
          if (candidate.prevRank !== null && candidate.prevRank !== candidate.currentRank) {
            const change = candidate.prevRank - candidate.currentRank;
            
            if (change > 0) {
              rankChange = `<i class="fa fa-arrow-up text-success ml-1"></i>`;
              rankClass = 'rank-up';
            } else if (change < 0) {
              rankChange = `<i class="fa fa-arrow-down text-error ml-1"></i>`;
              rankClass = 'rank-down';
            }
          }
          
          rankCell.innerHTML = `<span class="${rankClass}">${candidate.displayRank}</span>${rankChange}`;
          
          // 候选人单元格
          const candidateCell = document.createElement('td');
          candidateCell.className = 'py-3 flex items-center';
          
          const avatarImg = document.createElement('img');
          avatarImg.src = candidate.avatar;
          avatarImg.alt = candidate.name;
          avatarImg.className = 'w-10 h-10 rounded-full mr-3 object-cover';
          
          const nameSpan = document.createElement('span');
          
          // 根据角色设置不同颜色
          if (candidate.role === "皇帝") {
            nameSpan.className = 'font-medium text-yellow-400';
          } else if (candidate.role === "小皇弟") {
            nameSpan.className = 'font-medium text-purple-400';
          } else {
            nameSpan.className = 'font-medium text-blue-400';
          }
          
          nameSpan.textContent = candidate.name;
          
          candidateCell.appendChild(avatarImg);
          candidateCell.appendChild(nameSpan);
          
          // 票数单元格
          const votesCell = document.createElement('td');
          votesCell.className = 'py-3';
          votesCell.textContent = candidate.votes;
          
          // 角色单元格
          const roleCell = document.createElement('td');
          roleCell.className = 'py-3';
          
          const roleBadge = document.createElement('span');
          roleBadge.className = `px-2 py-1 rounded-full text-xs font-medium ${
            candidate.role === "皇帝" ? "bg-yellow-500 text-white" : 
            candidate.role === "小皇弟" ? "bg-purple-500 text-white" : "bg-blue-500 text-white"
          }`;
          roleBadge.textContent = candidate.role;
          
          roleCell.appendChild(roleBadge);
          
          // 趋势单元格
          const trendCell = document.createElement('td');
          trendCell.className = 'py-3';
          
          // 计算趋势
          const trend = calculateTrend(candidate.id);
          
          if (trend > 0) {
            trendCell.innerHTML = `<span class="text-success"><i class="fa fa-arrow-up"></i> ${trend}%</span>`;
          } else if (trend < 0) {
            trendCell.innerHTML = `<span class="text-error"><i class="fa fa-arrow-down"></i> ${Math.abs(trend)}%</span>`;
          } else {
            trendCell.innerHTML = `<span class="text-gray-500"><i class="fa fa-minus"></i> 持平</span>`;
          }
          
          // 组装行
          row.appendChild(rankCell);
          row.appendChild(candidateCell);
          row.appendChild(votesCell);
          row.appendChild(roleCell);
          row.appendChild(trendCell);
          
          // 添加到表格
          rankingBody.appendChild(row);
        });
      }
      
      // 计算趋势（模拟数据）
      function calculateTrend(candidateId) {
        // 随机生成-5%到5%之间的趋势值
        return Math.floor(Math.random() * 11) - 5;
      }
      
      // 更新统计数据
      function updateStats() {
        // 计算总投票数
        const totalVotes = candidatesData.reduce((sum, candidate) => sum + candidate.votes, 0);
        document.getElementById('total-votes').textContent = totalVotes;
        
        // 计算今日投票数（模拟）
        const todayVotes = Math.floor(totalVotes * 0.3);
        document.getElementById('today-votes').textContent = todayVotes;
        
        // 计算参与用户数（模拟）
        const activeUsers = Math.floor(todayVotes * 0.8);
        document.getElementById('active-users').textContent = activeUsers;
        
        // 计算投票率（模拟）
        const voteRate = Math.floor((activeUsers / 1000) * 100);
        document.getElementById('vote-rate').textContent = `${voteRate}%`;
        
        // 更新候选人统计图表
        updateCandidatesStatsChart();
      }
      
      // 更新候选人统计图表
      function updateCandidatesStatsChart() {
        const ctx = document.getElementById('candidates-stats-chart').getContext('2d');
        
        // 如果图表已存在，销毁它
        if (window.candidatesChart) {
          window.candidatesChart.destroy();
        }
        
        // 创建新图表
        window.candidatesChart = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: candidatesData.map(candidate => candidate.name),
            datasets: [{
              label: '票数',
              data: candidatesData.map(candidate => candidate.votes),
              backgroundColor: [
                'rgba(217, 119, 6, 0.7)', // 皇帝-金色
                'rgba(139, 92, 246, 0.7)', // 小皇弟-紫色
                'rgba(58, 191, 248, 0.7)'  // 皇弟-蓝色
              ],
              borderColor: [
                'rgb(217, 119, 6)',
                'rgb(139, 92, 246)',
                'rgb(58, 191, 248)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: {
                  color: 'rgba(255, 255, 255, 0.7)',
                  padding: 20,
                  usePointStyle: true,
                  pointStyle: 'circle'
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.raw || 0;
                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                    const percentage = Math.round((value / total) * 100);
                    return `${label}: ${value} 票 (${percentage}%)`;
                  }
                }
              }
            },
            cutout: '65%'
          }
        });
      }
      
      // 保存投票数据到本地存储
      function saveVoteData() {
        localStorage.setItem('voteData', JSON.stringify({
          userVote: userVote,
          userVoteTime: userVoteTime,
          candidatesData: candidatesData
        }));
      }
      
      // 从本地存储加载投票数据
      function loadVoteData() {
        const voteData = localStorage.getItem('voteData');
        
        if (voteData) {
          try {
            const parsedData = JSON.parse(voteData);
            userVote = parsedData.userVote;
            userVoteTime = parsedData.userVoteTime;
            candidatesData = parsedData.candidatesData;
            
            // 如果投票已过期，重置用户投票
            if (isVoteExpired()) {
              userVote = null;
              userVoteTime = null;
            }
            
            // 更新排名
            updateRanking();
          } catch (e) {
            console.error('Failed to load vote data:', e);
            initCandidatesData();
          }
        } else {
          initCandidatesData();
        }
      }
      
      // 初始化
      loadVoteData();
      
      // 渲染初始UI
      renderCandidatesGrid();
      renderRankingList();
      updateVoteStatus();
      updateStats();
      
      // 设置排序选择事件
      const sortSelect = document.getElementById('sort-select');
      sortSelect.addEventListener('change', function() {
        renderRankingList();
      });
      
      // 设置登录按钮事件
      const loginButtons = document.querySelectorAll('#login-button, #mobile-login-button, #hero-vote-button');
      loginButtons.forEach(button => {
        button.addEventListener('click', function() {
          alert('登录功能将在实际部署时实现');
        });
      });
      
      // 设置移动端菜单切换
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      
      mobileMenuButton.addEventListener('click', function() {
        mobileMenu.classList.toggle('hidden');
      });
      
      // 设置平滑滚动
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          
          const targetId = this.getAttribute('href');
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            window.scrollTo({
              top: targetElement.offsetTop - 80, // 考虑导航栏高度
              behavior: 'smooth'
            });
            
            // 如果是移动端，点击后关闭菜单
            if (!mobileMenu.classList.contains('hidden')) {
              mobileMenu.classList.add('hidden');
            }
          }
        });
      });
      
      // 每隔一段时间更新投票状态
      setInterval(updateVoteStatus, 60000);
    });
  </script>
</body>
</html>  
